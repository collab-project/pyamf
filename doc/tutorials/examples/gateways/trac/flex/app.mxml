<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark"
			   width="100%" height="100%">

	<s:layout>
		<s:VerticalLayout gap="10" verticalAlign="middle"
						  horizontalAlign="center" />
	</s:layout>
	
	<fx:Script>
		<![CDATA[
			private var _connection : NetConnection;
			private var _responder	: Responder;
			private const _url		: String = 'http://localhost:8000/login/rpc';
			private const _username	: String = 'admin';
			private const _password	: String = 'admin';
			
			protected function apiVersion_clickHandler(event:MouseEvent):void
			{
				// connection
				_responder = new Responder(displayResult, remoteFault);
				_connection = new NetConnection();
				_connection.connect( _url );
				
				// add authentication
				// http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/utils/Base64Encoder.html
				var auth:String = '123'; //base64.encodestring('%s:%s' % (_username, _password))[:-1];
				_connection.addHeader("Authorization", true, "Basic " + auth);
				
				// call service
				_connection.call("system.getAPIVersion", _responder);
			}
		
			import mx.utils.ObjectUtil;
			
			private function displayResult(re:*): void {
				result.text += ObjectUtil.toString(re) + "\n";
			}
			
			private function scrambleResult(re:*): void {
				result.text = re.result as String;
			}
			
			private function remoteFault(fault:*): void {
				result.text = fault.fault.faultDetail;
			}
		]]>
	</fx:Script>

	<s:Button label="API Version" click="apiVersion_clickHandler(event)"/>
	
    <s:RichText id="result" width="100%"
				textAlign="center" verticalAlign="middle"/>

</s:Application>
